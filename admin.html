<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Playres â€” Panel de AdministraciÃ³n</title>
  <link href="https://fonts.googleapis.com/css2?family=Michroma&family=Unica+One&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>

<div class="admin-wrapper">

  <!-- SIDEBAR -->
  <aside class="admin-sidebar">
    <div class="sidebar-brand">
      PLAY<span>R</span>ES
      <span class="sidebar-brand-sub">ADMIN PANEL</span>
    </div>

    <div class="sidebar-label">Principal</div>
    <ul class="sidebar-nav">
      <li><a href="index.html"><span class="nav-icon">ğŸ </span> Ir al sitio</a></li>
    </ul>

    <div class="sidebar-label">CatÃ¡logo</div>
    <ul class="sidebar-nav">
      <li><a href="admin.html" class="active"><span class="nav-icon">ğŸ®</span> Productos</a></li>
      <li><a href="#"><span class="nav-icon">ğŸ“¦</span> Reservas</a></li>
      <li><a href="#"><span class="nav-icon">â­</span> ReseÃ±as</a></li>
    </ul>

    <div class="sidebar-label">Sistema</div>
    <ul class="sidebar-nav">
      <li><a href="#"><span class="nav-icon">ğŸ‘¥</span> Usuarios</a></li>
      <li><a href="#"><span class="nav-icon">âš™ï¸</span> ConfiguraciÃ³n</a></li>
    </ul>

    <div class="sidebar-footer">
      <div class="sidebar-user">
        <div class="sidebar-avatar">A</div>
        <div>
          <div class="sidebar-user-name">Admin</div>
          <div class="sidebar-user-role">Superadmin</div>
        </div>
        <a href="index.html" class="sidebar-exit-btn">Salir</a>
      </div>
    </div>
  </aside>

  <!-- MAIN -->
  <main class="admin-main">

    <!-- Topbar -->
    <div class="admin-topbar">
      <div class="topbar-title">Panel de <span>AdministraciÃ³n</span></div>
      <div class="topbar-actions">
        <span class="topbar-badge">ğŸŸ¢ Sistema activo</span>
        <span class="admin-version-label">Playres v2.0</span>
      </div>
    </div>

    <div class="admin-content">

      <!-- Stats -->
      <div class="stats-grid">
        <div class="stat-card">
          <span class="stat-card-icon">ğŸ®</span>
          <div class="stat-card-label">Total productos</div>
          <div class="stat-card-value" id="totalCount">12</div>
          <div class="stat-card-sub up">â†‘ +3 este mes</div>
        </div>
        <div class="stat-card">
          <span class="stat-card-icon">âœ…</span>
          <div class="stat-card-label">Disponibles</div>
          <div class="stat-card-value" id="availCount">8</div>
          <div class="stat-card-sub up">â†‘ En stock</div>
        </div>
        <div class="stat-card">
          <span class="stat-card-icon">ğŸ“¦</span>
          <div class="stat-card-label">Reservados</div>
          <div class="stat-card-value" id="reservedCount">3</div>
          <div class="stat-card-sub">â†” Activos</div>
        </div>
        <div class="stat-card">
          <span class="stat-card-icon">âŒ</span>
          <div class="stat-card-label">Agotados</div>
          <div class="stat-card-value" id="outCount">1</div>
          <div class="stat-card-sub down">â†“ Sin stock</div>
        </div>
      </div>

      <!-- Toolbar -->
      <div class="table-toolbar">
        <div class="table-toolbar-left">
          <button class="btn-add-product" onclick="openAddModal()">ï¼‹ Agregar producto</button>
          <div class="admin-search">
            <svg width="14" height="14" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" style="color:var(--muted);flex-shrink:0"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
            <input type="text" id="searchInput" placeholder="Buscar juego..." oninput="filterTable()">
          </div>
          <select class="admin-filter-select" id="platformFilter" onchange="filterTable()">
            <option value="">ğŸ® Todas las plataformas</option>
            <option value="PS5">PlayStation 5</option>
            <option value="Xbox">Xbox Series X</option>
            <option value="Switch">Nintendo Switch</option>
            <option value="PC">PC</option>
          </select>
          <select class="admin-filter-select" id="statusFilter" onchange="filterTable()">
            <option value="">ğŸ“‹ Todos los estados</option>
            <option value="disponible">Disponible</option>
            <option value="reservado">Reservado</option>
            <option value="agotado">Agotado</option>
          </select>
        </div>
        <div class="admin-result-count" id="resultCount">Mostrando 12 productos</div>
      </div>

      <!-- Tabla -->
      <div class="admin-table-wrap">
        <table class="admin-table" id="productsTable">
          <thead>
            <tr>
              <th>Producto</th>
              <th>Plataforma</th>
              <th>GÃ©nero</th>
              <th class="sortable">Precio/dÃ­a â†•</th>
              <th>Rating</th>
              <th>Estado</th>
              <th>Stock</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody id="tableBody"></tbody>
        </table>
      </div>

      <!-- PaginaciÃ³n -->
      <div class="admin-pagination">
        <div class="pagination-info" id="pagInfo">Mostrando 1â€“8 de 12 productos</div>
        <div class="pagination-btns">
          <button class="pag-btn" id="prevPage" onclick="changePage(-1)" disabled>â†</button>
          <button class="pag-btn active" id="page1" onclick="goPage(1)">1</button>
          <button class="pag-btn" id="page2" onclick="goPage(2)">2</button>
          <button class="pag-btn" id="nextPage" onclick="changePage(1)">â†’</button>
        </div>
      </div>

    </div>
  </main>
</div>

<!-- MODAL AGREGAR / EDITAR -->
<div class="modal fade modal-playres" id="productModal" tabindex="-1">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="modalTitle">â• Agregar producto</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <input type="hidden" id="editIndex" value="-1">
        <div class="row g-3">
          <div class="col-md-8">
            <label class="form-label-playres">TÃ­tulo del juego</label>
            <input type="text" class="form-control-playres" id="fTitle" placeholder="Ej: Elden Ring">
          </div>
          <div class="col-md-4">
            <label class="form-label-playres">Plataforma</label>
            <select class="form-control-playres" id="fPlatform">
              <option value="PS5">PlayStation 5</option>
              <option value="Xbox">Xbox Series X</option>
              <option value="Switch">Nintendo Switch</option>
              <option value="PC">PC</option>
            </select>
          </div>
          <div class="col-md-4">
            <label class="form-label-playres">GÃ©nero</label>
            <select class="form-control-playres" id="fGenre">
              <option>RPG</option>
              <option>AcciÃ³n</option>
              <option>Aventura</option>
              <option>Deportes</option>
              <option>Carreras</option>
              <option>Sci-Fi</option>
              <option>Puzzle</option>
            </select>
          </div>
          <div class="col-md-4">
            <label class="form-label-playres">Precio por dÃ­a ($)</label>
            <input type="number" class="form-control-playres" id="fPrice" placeholder="9900">
          </div>
          <div class="col-md-4">
            <label class="form-label-playres">Stock disponible</label>
            <input type="number" class="form-control-playres" id="fStock" placeholder="50">
          </div>
          <div class="col-md-4">
            <label class="form-label-playres">Rating (1â€“5)</label>
            <input type="number" class="form-control-playres" id="fRating" placeholder="4.9" step="0.1" min="1" max="5">
          </div>
          <div class="col-md-4">
            <label class="form-label-playres">Estado</label>
            <select class="form-control-playres" id="fStatus">
              <option value="disponible">Disponible</option>
              <option value="reservado">Reservado</option>
              <option value="agotado">Agotado</option>
            </select>
          </div>
          <div class="col-md-4">
            <label class="form-label-playres">Emoji / Ãcono</label>
            <select class="form-control-playres" id="fEmoji">
              <option value="ğŸŒŒ">ğŸŒŒ Galaxia</option>
              <option value="ğŸ”´">ğŸ”´ Rojo</option>
              <option value="ğŸŒ¿">ğŸŒ¿ Aventura</option>
              <option value="ğŸš€">ğŸš€ Sci-Fi</option>
              <option value="âš”ï¸">âš”ï¸ Espada</option>
              <option value="ğŸï¸">ğŸï¸ Carrera</option>
              <option value="ğŸ‰">ğŸ‰ DragÃ³n</option>
              <option value="âš½">âš½ Deportes</option>
            </select>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn-cancel-modal" data-bs-dismiss="modal">Cancelar</button>
        <button class="btn-save-modal" onclick="saveProduct()">Guardar producto</button>
      </div>
    </div>
  </div>
</div>

<!-- MODAL ELIMINAR -->
<div class="modal fade modal-playres" id="deleteModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered modal-sm">
    <div class="modal-content">
      <div class="modal-body admin-delete-body">
        <div class="modal-delete-icon">ğŸ—‘ï¸</div>
        <div class="modal-delete-title">Â¿Eliminar producto?</div>
        <p class="modal-delete-sub">Vas a eliminar <span class="modal-delete-game-name" id="deleteGameName"></span>. Esta acciÃ³n no se puede deshacer.</p>
        <div class="admin-delete-actions">
          <button class="btn-cancel-modal" data-bs-dismiss="modal">Cancelar</button>
          <button class="btn-confirm-delete" onclick="confirmDelete()">SÃ­, eliminar</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- TOAST -->
<div class="playres-toast" id="toastEl">
  <span class="toast-icon" id="toastIcon">âœ…</span>
  <span class="toast-msg" id="toastMsg">Producto guardado</span>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
  let products = [
    { id:'PLY-001', title:'Elden Ring: Shadow of the Erdtree', platform:'PS5',    genre:'RPG',      price:9900, rating:4.9, stock:120, status:'disponible', emoji:'ğŸŒŒ', bg:'game-thumb-purple' },
    { id:'PLY-002', title:'Spider-Man 2',                      platform:'Xbox',   genre:'AcciÃ³n',   price:8500, rating:4.8, stock:85,  status:'reservado',  emoji:'ğŸ”´', bg:'game-thumb-red'    },
    { id:'PLY-003', title:'Zelda: Tears of the Kingdom',       platform:'Switch', genre:'Aventura', price:8900, rating:4.9, stock:200, status:'disponible', emoji:'ğŸŒ¿', bg:'game-thumb-green'  },
    { id:'PLY-004', title:'Starfield: Shattered Space',        platform:'PC',     genre:'Sci-Fi',   price:7900, rating:4.5, stock:60,  status:'disponible', emoji:'ğŸš€', bg:'game-thumb-blue'   },
    { id:'PLY-005', title:'Final Fantasy XVI',                 platform:'PS5',    genre:'RPG',      price:8200, rating:4.7, stock:45,  status:'disponible', emoji:'âš”ï¸', bg:'game-thumb-purple' },
    { id:'PLY-006', title:'Forza Horizon 5: Rally',            platform:'Xbox',   genre:'Carreras', price:7500, rating:4.6, stock:0,   status:'agotado',    emoji:'ğŸï¸', bg:'game-thumb-red'    },
    { id:'PLY-007', title:'FIFA 25',                           platform:'PS5',    genre:'Deportes', price:6900, rating:4.3, stock:300, status:'disponible', emoji:'âš½', bg:'game-thumb-green'  },
    { id:'PLY-008', title:'Hogwarts Legacy',                   platform:'Switch', genre:'Aventura', price:7800, rating:4.4, stock:75,  status:'reservado',  emoji:'ğŸ‰', bg:'game-thumb-blue'   },
    { id:'PLY-009', title:'Call of Duty: Black Ops 6',         platform:'Xbox',   genre:'AcciÃ³n',   price:9500, rating:4.6, stock:150, status:'disponible', emoji:'ğŸ”´', bg:'game-thumb-red'    },
    { id:'PLY-010', title:'Cyberpunk 2077: Phantom Liberty',   platform:'PC',     genre:'RPG',      price:8800, rating:4.8, stock:90,  status:'disponible', emoji:'ğŸŒŒ', bg:'game-thumb-purple' },
    { id:'PLY-011', title:'Mario Kart 8 Deluxe',              platform:'Switch', genre:'Carreras', price:6500, rating:4.9, stock:250, status:'reservado',  emoji:'ğŸï¸', bg:'game-thumb-green'  },
    { id:'PLY-012', title:'Resident Evil 4 Remake',            platform:'PS5',    genre:'AcciÃ³n',   price:7200, rating:4.8, stock:110, status:'disponible', emoji:'ğŸ”´', bg:'game-thumb-red'    },
  ];

  let filteredProducts = [...products];
  let currentPage = 1;
  const perPage = 8;
  let deleteIndex = -1;

  function renderTable() {
    const start = (currentPage - 1) * perPage;
    const slice = filteredProducts.slice(start, start + perPage);

    document.getElementById('tableBody').innerHTML = slice.map(p => {
      const realIdx = products.indexOf(p);
      return `
        <tr>
          <td>
            <div class="tbl-game-info">
              <div class="tbl-thumb ${p.bg}">${p.emoji}</div>
              <div>
                <div class="tbl-game-name">${p.title}</div>
                <div class="tbl-game-id">${p.id}</div>
              </div>
            </div>
          </td>
          <td><span class="platform-tbl">${p.platform}</span></td>
          <td>${p.genre}</td>
          <td class="tbl-price">$${p.price.toLocaleString('es-CO')}</td>
          <td><span class="tbl-stars">${'â˜…'.repeat(Math.floor(p.rating))}</span> <span class="tbl-rating-num">${p.rating}</span></td>
          <td><span class="status-badge ${p.status}">${p.status.charAt(0).toUpperCase()+p.status.slice(1)}</span></td>
          <td class="${p.stock===0?'tbl-stock-out':'tbl-stock'}">${p.stock}</td>
          <td>
            <div class="action-btns">
              <button class="btn-edit" onclick="openEditModal(${realIdx})">âœï¸ Editar</button>
              <button class="btn-delete" onclick="openDeleteModal(${realIdx})">ğŸ—‘ï¸</button>
            </div>
          </td>
        </tr>`;
    }).join('');

    const totalPages = Math.ceil(filteredProducts.length / perPage);
    document.getElementById('prevPage').disabled = currentPage === 1;
    document.getElementById('nextPage').disabled = currentPage === totalPages;
    document.getElementById('page1').classList.toggle('active', currentPage === 1);
    document.getElementById('page2').classList.toggle('active', currentPage === 2);
    document.getElementById('page2').style.display = totalPages < 2 ? 'none' : 'flex';

    const from = start + 1;
    const to   = Math.min(start + perPage, filteredProducts.length);
    document.getElementById('pagInfo').textContent = `Mostrando ${from}â€“${to} de ${filteredProducts.length} productos`;
    document.getElementById('resultCount').textContent = `Mostrando ${filteredProducts.length} producto${filteredProducts.length!==1?'s':''}`;

    document.getElementById('totalCount').textContent    = products.length;
    document.getElementById('availCount').textContent    = products.filter(p=>p.status==='disponible').length;
    document.getElementById('reservedCount').textContent = products.filter(p=>p.status==='reservado').length;
    document.getElementById('outCount').textContent      = products.filter(p=>p.status==='agotado').length;
  }

  function filterTable() {
    const q   = document.getElementById('searchInput').value.toLowerCase();
    const plt = document.getElementById('platformFilter').value;
    const sts = document.getElementById('statusFilter').value;
    filteredProducts = products.filter(p =>
      (!q   || p.title.toLowerCase().includes(q) || p.id.toLowerCase().includes(q)) &&
      (!plt || p.platform === plt) &&
      (!sts || p.status   === sts)
    );
    currentPage = 1;
    renderTable();
  }

  function changePage(dir) { currentPage += dir; renderTable(); }
  function goPage(n)       { currentPage = n;   renderTable(); }

  function openAddModal() {
    document.getElementById('modalTitle').textContent = 'â• Agregar producto';
    document.getElementById('editIndex').value = -1;
    ['fTitle','fPrice','fStock','fRating'].forEach(id => document.getElementById(id).value = '');
    document.getElementById('fPlatform').value = 'PS5';
    document.getElementById('fGenre').value    = 'RPG';
    document.getElementById('fStatus').value   = 'disponible';
    document.getElementById('fEmoji').value    = 'ğŸŒŒ';
    new bootstrap.Modal(document.getElementById('productModal')).show();
  }

  function openEditModal(idx) {
    const p = products[idx];
    document.getElementById('modalTitle').textContent = 'âœï¸ Editar producto';
    document.getElementById('editIndex').value  = idx;
    document.getElementById('fTitle').value     = p.title;
    document.getElementById('fPrice').value     = p.price;
    document.getElementById('fStock').value     = p.stock;
    document.getElementById('fRating').value    = p.rating;
    document.getElementById('fPlatform').value  = p.platform;
    document.getElementById('fGenre').value     = p.genre;
    document.getElementById('fStatus').value    = p.status;
    document.getElementById('fEmoji').value     = p.emoji;
    new bootstrap.Modal(document.getElementById('productModal')).show();
  }

  function saveProduct() {
    const idx   = parseInt(document.getElementById('editIndex').value);
    const title = document.getElementById('fTitle').value.trim();
    const price = parseInt(document.getElementById('fPrice').value);
    if (!title || !price) { showToast('danger','âš ï¸','Completa tÃ­tulo y precio.'); return; }

    const bgMap = { PS5:'game-thumb-purple', Xbox:'game-thumb-red', Switch:'game-thumb-green', PC:'game-thumb-blue' };
    const platform = document.getElementById('fPlatform').value;

    const prod = {
      id:       idx >= 0 ? products[idx].id : 'PLY-' + String(products.length+1).padStart(3,'0'),
      title, platform,
      genre:    document.getElementById('fGenre').value,
      price,
      rating:   parseFloat(document.getElementById('fRating').value) || 4.5,
      stock:    parseInt(document.getElementById('fStock').value) || 0,
      status:   document.getElementById('fStatus').value,
      emoji:    document.getElementById('fEmoji').value,
      bg:       bgMap[platform] || 'game-thumb-purple',
    };

    if (idx >= 0) { products[idx] = prod; showToast('success','âœ…','Producto actualizado.'); }
    else          { products.push(prod);  showToast('success','âœ…','Producto agregado.'); }

    filteredProducts = [...products];
    filterTable();
    bootstrap.Modal.getInstance(document.getElementById('productModal')).hide();
  }

  function openDeleteModal(idx) {
    deleteIndex = idx;
    document.getElementById('deleteGameName').textContent = '"' + products[idx].title + '"';
    new bootstrap.Modal(document.getElementById('deleteModal')).show();
  }

  function confirmDelete() {
    if (deleteIndex < 0) return;
    const name = products[deleteIndex].title;
    products.splice(deleteIndex, 1);
    deleteIndex = -1;
    filteredProducts = [...products];
    filterTable();
    bootstrap.Modal.getInstance(document.getElementById('deleteModal')).hide();
    showToast('danger','ğŸ—‘ï¸',`"${name}" eliminado.`);
  }

  let toastTimer;
  function showToast(type, icon, msg) {
    const el = document.getElementById('toastEl');
    document.getElementById('toastIcon').textContent = icon;
    document.getElementById('toastMsg').textContent  = msg;
    el.className = `playres-toast ${type} show`;
    clearTimeout(toastTimer);
    toastTimer = setTimeout(() => el.classList.remove('show'), 3000);
  }

  renderTable();
</script>
</body>
</html>